<!DOCTYPE html>
<html lang="en">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/stylesheets/min/post-min.css">
<link rel="stylesheet" href="/stylesheets/min/dark-min.css" media="(prefers-color-scheme: dark)">

<title>A Review of ungoogled-chromium Patches</title>
<h1>A Review of ungoogled-chromium Patches</h1>
<time datetime="2021-04-03">April 3, 2021</time>

<p>In the present day, having a secure browser is more important than ever. Being the most used application in the system, the browser represents a large attack surface because it processes untrusted input combined with being a written in an unsafe language while having a codebase whose size can rival some operating systems. However, many browsers come out of the box with weak privacy. <a href="https://github.com/eloston/ungoogled-chromium">ungoogled-chromium</a> is an oft recommended browser because of its Chromium base and degoogled properties. However, I have a couple of concerns with this recommendation, namely:

<ul>
  <li>ungoogled-chromium lags behind upstream Chrome for days every release.
  <li>There are no official binaries; third parties contribute prebuilt binaries, so there is no central party to trust.
  <li><a href="https://github.com/Eloston/ungoogled-chromium/commit/7f238719fa0a16e40559df36988aecf0082a8cf3">Control Flow Integrity is disabled by default, leaving users vulnerable to control-flow hijacking.</a>
  <li>Component updates are disabled.
  <li>Documentation and troubleshooting links in the browser are broken.
</ul>

<p>Security issues aside, they must be doing unique and great work in privacy, right?

<p>No. Most of the functionality of the patches are either in the best case minimally beneficial or can be reproduced with either a setting, a flag, or a switch, and using a browser specifically for these patches is not worth the tradeoff in security.

<p>This article aims to detail the patches in the order they apply in, their functions, and how they can be reproduced in Chrome.

<h4>0001-fix-building-without-safebrowsing.patch, unrar.patch, safe_browsing-disable-incident-reporting.patch, safe_browsing-disable-reporting-of-safebrowsing-over.patch, remove-unused-preferences-fields.patch</h4>
<p>These patches disable safe browsing. Related prefs are removed in <code>remove-unused-preferences-fields</code>.
<p>— Safe browsing can be turned off in <code>chrome://settings</code>.

<h4>0003-disable-autofill-download-manager.patch</h4>
<p>This patch disables form Autofill data transmission to Google.
<p>— Autofill can be turned off in <code>chrome://settings</code>.

<h4>0005-disable-default-extensions.patch</h4>
<p>This patch disables:
<ul>
  <li>Google Wallet 
  <li>Google Feedback
  <li>Google Web Store
  <li>Google Hangouts
  <li>Google Branding
</ul>

<h4>0007-disable-web-resource-service.patch</h4>
<p>This patch disables Chrome's WebResourceService, which periodically fetches JSON data from a Google server to dynamically configure the browser.

<h4>0009-disable-google-ipv6-probes.patch</h4>
<p>This patch uses RIPE NCC servers instead of Google servers for IPv6 probes.

<h4>0015-disable-update-pings.patch</h4>
<p>This patch disables pings to clients2.google.com/ for component updates.
<p>— Component updates can be disabled with switch <code>--disable-component-update</code>. 

<h4>0017-disable-new-avatar-menu.patch</h4>
<p>This cosmetic patch disables the new avatar menu.

<h4>0021-disable-rlz.patch</h4>
<p>This patch disables RLZ, a promotional tag only found in Chrome.

<p><a href="https://www.google.com/chrome/privacy/whitepaper.html">This non-unique tag sent is sent with Google searches and crash reports</a>
<p>— RLZ can be disabled by defining <code>"rlz_disabled":true</code> in the preferences file.

<h4>disable-crash-reporter.patch</h4>
<p>This patch disables the uploading of crash reports to Google. <a href="https://chromium.googlesource.com/chromium/src/+/master/docs/chromium_browser_vs_google_chrome.md">Chromium does not report crashes.</a>
<p>— Disable the crash reporter with switch <code>--disable-crash-reporter</code>.

<h4>disable-google-host-detection.patch</h4>
<p>This patch disables Google specific features and restrictions applied to Google domains.

<h4>replace-google-search-engine-with-nosearch.patch</h4>
<p>This patch replaces Google with "No Search" (disables search from omnibox).
<p>— Use another search engine.

<h4>disable-signin.patch, fix-building-without-one-click-signin.patch, disable-gaia.patch</h4>
<p>This patch disables browser management of sign-in of Google Accounts. Requires API keys found only in Chrome.
<p>— Disabled with switches <code>--disable-gaia-services</code>, <code>--disable-sync</code>, <code>--allow-browser-signin=false</code>

<h4>toggle-translation-via-switch.patch</h4>
<p>This patch disables translation and removes the "Translate to" context menu when --translate-script-url flag is not set.
<p>— Define a non-existent <code>--translate-script-url</code>.

<h4>all-add-trk-prefixes-to-possibly-evil-connection.patch, disable-untraceable-urls.patch, block-trk-and-subdomains.patch, disable-webstore-urls.patch, fix-learn-doubleclick-hsts.patch, block-requests.patch</h4>
<p>These patches disable all connections hard-coded into the browser using domain substitution. A lot of these connections are only made on user interaction and not transparently made in the background.

<p>Connections patched out include
<ul>
  <li>AppID faucets used in U2F,
  <li>Browser customization,
  <li>Chrome Web Store,
  <li>Component and Extension updaters,
  <li>Documentation: e.g. the "learn more" page in incognito mode.,
  <li>Extensions functionality,
  <li>Login endpoints,
  <li>Logs and Crash report uploaders,
  <li>Et cetera.
</ul>

<details>
    <summary><a href="https://github.com/lynn-stephenson">@lynn-stephenson</a> — you can even change the URLs of "Google URLs" with some switches</summary>
    <p><code>--google-apis-url</code>
    <p><code>--google-base-url</code>
    <p><code>--google-url</code>
    <p><code>--autofill-assistant-url</code>
    <p><code>--autofill-server-url</code>
    <p><code>--cloud-print-url</code>
    <p><code>--connectivity-check-url</code>
    <p><code>--crash-server-url</code>
    <p><code>--cryptauth-http-host</code>
    <p><code>--cryptauth-v2-devicesync-http-host</code>
    <p><code>--cryptauth-v2-enrollment-http-host</code>
    <p><code>--data-reduction-proxy-config-url</code>
    <p><code>--data-reduction-proxy-pingback-url</code>
    <p><code>--data-reduction-proxy-secure-proxy-check-url</code>
    <p><code>--device-management-url</code>
    <p><code>--disable-sync</code>
    <p><code>--disable-sync-types</code>
</details>

<h4>disable-profile-avatar-downloading.patch</h4>
<p>This patch disables the downloading of profile avatars from Google.

<h4>disable-gcm.patch</h4>
<p>Disables the Google Cloud Messaging component. Extensions can use the <code>chrome.gcm</code> API to send messages through Firebase Cloud Messaging.

<h4>disable-domain-reliability.patch</h4>
<p>The domain reliability monitor sends info to Google whenever an error occurs while visiting a Google domain.
<p>— Disable domain reliability with switch <code>--disable-domain-reliability</code>.

<h4>disable-fonts-googleapis-references.patch</h4>
<p>This patch disables references to <code>fonts.googleapis.com</code> hardcoded in the browser.

<h4>disable-webrtc-log-uploader.patch</h4>
<p>This patch disables the uploading of WebRTC logs for the Hangouts extension. 
<p>— Disable reporting additional diagnostics in Hangouts settings.

<h4>use-local-devtools-files.patch</h4>
<p>This patch always uses local DevTools files instead of fetching remote files from Google.

<h4>disable-network-time-tracker.patch</h4>
<p>This patch disables connections to Google to check if the system time is correct when a website certificate date seems incorrect.
<p>— Disable the network time tracker with switch <code>--disable-features=NetworkTimeServiceQuerying</code>

<h4>disable-mei-preload.patch</h4>
<p>This patch disables downloading of a list of sites with a high Media Engagement Index, used to determine whether or not a site autoplays.
<p>— Disable MEI preload with switch <code>--disable-features=PreloadMediaEngagementData, MediaEngagementBypassAutoplayPolicies</code>

<h4>fix-building-without-enabling-reporting.patch</h4>
<p>This patch disables reporting violations such as COEP.

<h4>disable-fetching-field-trials.patch</h4>
<p>This patch disables the downloading of field trials (Google’s A/B testing).
<p>— Field trials can be disabled with switch <code>--disable-field-trial-config</code>.

<p>With the relative ease that these settings can be changed, there is no reason to use ungoogled-chromium as a main browser when Chrome can be configured similarly.
