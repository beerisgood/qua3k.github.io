<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Email (In)security - duck's pond</title><meta name=description content="There is no such thing as secure email. Email is an inherently insecure protocol, conceived at a time when security was an afterthought. There are fundamental flaws with email that cannot be mitigated by slapping encryption on top.
Problems with… Email Authentication Sender Policy Framework is a protocol used to authorize the mail transfer agents allowed to send mail on behalf of a domain. However, SPF is almost useless in spoofing protection alone as it is designed to protect against forged senders and not forged headers shown in clients."><meta name=author content="duck"><link href=https://qua3k.github.io/an-old-hope.min.css rel=stylesheet><link href=https://qua3k.github.io/style.css rel=stylesheet><link href=https://qua3k.github.io/custom.css rel=stylesheet><link rel=apple-touch-icon href=https://qua3k.github.io/apple-touch-icon.png><link rel=icon href=https://qua3k.github.io/favicon.ico><meta name=generator content="Hugo 0.83.1"><script>function setTheme(){if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');return}const c=new Date,g=localStorage.getItem('date'),d=String(c.getMonth()+1)+'.'+String(c.getDate()),e=c.getTime();let a,b;function f(){if(e>a&&e<b)return;document.body.classList.add('dark')}d!==g?(fetch('https://api.ipgeolocation.io/astronomy?apiKey=5ed37d85103e4defa5df4c5298ed5215').then(a=>a.json()).then(c=>{a=c.sunrise.split(':').map(Number),b=c.sunset.split(':').map(Number)}).catch(()=>{a=[7,0],b=[19,0]}).finally(()=>{a=c.setHours(a[0],a[1],0),b=c.setHours(b[0],b[1],0),f(),localStorage.setItem('sunrise',a),localStorage.setItem('sunset',b)}),localStorage.setItem('date',d)):(a=Number(localStorage.getItem('sunrise')),b=Number(localStorage.getItem('sunset')),f())}</script></head><body class=single><script>setTheme()</script><header class=header><nav class=nav><p class=logo><a href=https://qua3k.github.io/>duck's pond</a></p><ul class=menu><li><a href=/about/>about</a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Email (In)security</h1><div class=post-meta>duck · June 1, 2021</div></header><div class=post-content><p>There is no such thing as secure email. Email is an inherently insecure protocol, conceived at a time when security was an afterthought. There are fundamental flaws with email that cannot be mitigated by slapping encryption on top.</p><h2 id=problems-with>Problems with…</h2><h3 id=email-authentication>Email Authentication</h3><p><a href=https://tools.ietf.org/html/rfc7208>Sender Policy Framework</a> is a protocol used to authorize the mail transfer agents allowed to send mail on behalf of a domain. However, SPF is almost useless in spoofing protection alone as it is designed to protect against forged senders and not forged headers shown in clients.</p><ul><li>The limitations of SPF are evident in email forwarding, where it fails because the forwarding MTA&rsquo;s IP address in not in the published SPF record.</li></ul><p><a href=https://tools.ietf.org/html/rfc6376>DomainKeys Identified Mail</a> is a email authentication protocol meant to prove that an email does come from a specific domain by utilizing asymmetric cryptography, where the server generates a keypair and publishes the public key in a DNS record, to hash certain header fields and body, writing the signature of the hashes as an email header.</p><ul><li>DKIM is limited in its effectiveness in that it also does not prevent forging of email headers, only ensuring the integrity of the content.</li><li>DKIM signatures are also vulnerable to being stripped, and happens in practice because there is no standard way to signal that your emails must be signed unless you deploy DMARC.</li></ul><p><a href=https://tools.ietf.org/html/rfc7489>Domain-based Message Authentication, Reporting and Conformance</a> solves some of these problems by letting domain owners define a policy for the enforcement of SPF and DKIM and the handling of email authentication failures. DMARC alignment ensures the domain in the RFC5322.From address aligns with SPF or the DKIM domain tag and is an essential part of spoofing protection.</p><h3 id=transport-encryption>Transport Encryption</h3><p>Email was not designed with encryption in mind, so when it came time to introduce encryption for message transfer, STARTTLS arose.</p><ul><li>STARTTLS has is <a href=https://blog.filippo.io/the-sad-state-of-smtp-encryption/>opportunistic encryption</a>, meaning an active adversary has the ability to downgrade the connection and force the participants to converse in plaintext, <a href="https://youtube.com/watch?v=MFol6IMbZ7Y">akin to connecting to a website over <code>http:</code> and relying on the server to redirect to <code>https:</code></a>.</li></ul><p>There are plans to mitigate this, primarily with <a href=https://tools.ietf.org/html/rfc8461>MTA-STS</a> and <a href=https://tools.ietf.org/html/rfc7672>DANE</a>.</p><ul><li>MTA-STS allows mail servers to advertise their ability to receive TLS connections by advertising support in a DNS TXT record and serving the policy over <code>https:</code>. MTA-STS uses a TOFU model and relies on the security of certificate authorities and DNS.</li><li>DANE has the same end goal, but takes a different approach. DNSSEC can ensure authenticity and integrity of DANE TLSA records so receivers can verify certificates without relying on CAs.</li></ul><h3 id=email-encryption>Email Encryption</h3><p><a href=https://tools.ietf.org/html/rfc4880>OpenPGP</a>, the de facto standard for email encryption, has <a href=https://www.whonix.org/wiki/OpenPGP#Issues_with_PGP>numerous problems</a>. Email encryption also cannot protect metadata such as the sender, recipient, and timestamps, something modern messengers like <a href=https://signal.org>Signal</a> has done with its <a href=https://signal.org/blog/sealed-sender/>sealed sender</a>.</p><h3 id=mailbox-encryption>Mailbox Encryption</h3><p>Providers using mailbox encryption can be <a href=https://www.theregister.com/2020/12/08/tutanota_backdoor_court_order/>legally compelled</a> to disable encryption of new incoming email. Providers have the ability can read all their mail if it is not encrypted.</p><h3 id=conclusion>Conclusion</h3><p>All of these security mechanisms are optional, and highlights a fundamental flaw in how email services operate. Basic steps such as requiring encryption for all messages will sever communications with entire swaths of providers, and email authentication support is still lackluster on most providers.</p><p>Avoid Email.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://qua3k.github.io/tags/email>email</a></li><li><a href=https://qua3k.github.io/tags/pgp>pgp</a></li><li><a href=https://qua3k.github.io/tags/privacy>privacy</a></li><li><a href=https://qua3k.github.io/tags/security>security</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://qua3k.github.io/>duck's pond</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hamsters</a>️</span>
<span>&#183;</span>
<span>Theme️ <a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper</a></span></footer><script src=https://qua3k.github.io/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></body></html>